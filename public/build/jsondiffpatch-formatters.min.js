!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var f;"undefined"!=typeof window?f=window:"undefined"!=typeof global?f=global:"undefined"!=typeof self&&(f=self),(f.jsondiffpatch||(f.jsondiffpatch={})).formatters=e()}}(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
module.exports=require("./formatters");
},{"./formatters":6}],2:[function(require,module,exports){
exports.isBrowser="undefined"!=typeof window;
},{}],3:[function(require,module,exports){
var base=require("./base"),BaseFormatter=base.BaseFormatter,AnnotatedFormatter=function(){this.includeMoveDestinations=!1};AnnotatedFormatter.prototype=new BaseFormatter,AnnotatedFormatter.prototype.prepareContext=function(t){BaseFormatter.prototype.prepareContext.call(this,t),t.indent=function(t){this.indentLevel=(this.indentLevel||0)+(void 0===t?1:t),this.indentPad=new Array(this.indentLevel+1).join("&nbsp;&nbsp;")},t.row=function(e,o){t.out('<tr><td style="white-space: nowrap;"><pre class="jsondiffpatch-annotated-indent" style="display: inline-block">'),t.out(t.indentPad),t.out('</pre><pre style="display: inline-block">'),t.out(e),t.out('</pre></td><td class="jsondiffpatch-delta-note"><div>'),t.out(o),t.out("</div></td></tr>")}},AnnotatedFormatter.prototype.typeFormattterErrorFormatter=function(t,e){t.row("",'<pre class="jsondiffpatch-error">'+e+"</pre>")},AnnotatedFormatter.prototype.formatTextDiffString=function(t,e){var o=this.parseTextDiff(e);t.out('<ul class="jsondiffpatch-textdiff">');for(var n=0,r=o.length;n<r;n++){var a=o[n];t.out('<li><div class="jsondiffpatch-textdiff-location"><span class="jsondiffpatch-textdiff-line-number">'+a.location.line+'</span><span class="jsondiffpatch-textdiff-char">'+a.location.chr+'</span></div><div class="jsondiffpatch-textdiff-line">');for(var i=a.pieces,d=0,p=i.length;d<p;d++){var f=i[d];t.out('<span class="jsondiffpatch-textdiff-'+f.type+'">'+f.text+"</span>")}t.out("</div></li>")}t.out("</ul>")},AnnotatedFormatter.prototype.rootBegin=function(t,e,o){t.out('<table class="jsondiffpatch-annotated-delta">'),"node"===e&&(t.row("{"),t.indent()),"array"===o&&t.row('"_t": "a",',"Array delta (member names indicate array indices)")},AnnotatedFormatter.prototype.rootEnd=function(t,e){"node"===e&&(t.indent(-1),t.row("}")),t.out("</table>")},AnnotatedFormatter.prototype.nodeBegin=function(t,e,o,n,r){t.row("&quot;"+e+"&quot;: {"),"node"===n&&t.indent(),"array"===r&&t.row('"_t": "a",',"Array delta (member names indicate array indices)")},AnnotatedFormatter.prototype.nodeEnd=function(t,e,o,n,r,a){"node"===n&&t.indent(-1),t.row("}"+(a?"":","))},AnnotatedFormatter.prototype.format_unchanged=function(){},AnnotatedFormatter.prototype.format_movedestination=function(){},AnnotatedFormatter.prototype.format_node=function(t,e,o){this.formatDeltaChildren(t,e,o)};var wrapPropertyName=function(t){return'<pre style="display:inline-block">&quot;'+t+"&quot;</pre>"},deltaAnnotations={added:function(t,e,o,n){var r=" <pre>([newValue])</pre>";return void 0===n?"new value"+r:"number"==typeof n?"insert at index "+n+r:"add property "+wrapPropertyName(n)+r},modified:function(t,e,o,n){var r=" <pre>([previousValue, newValue])</pre>";return void 0===n?"modify value"+r:"number"==typeof n?"modify at index "+n+r:"modify property "+wrapPropertyName(n)+r},deleted:function(t,e,o,n){var r=" <pre>([previousValue, 0, 0])</pre>";return void 0===n?"delete value"+r:"number"==typeof n?"remove index "+n+r:"delete property "+wrapPropertyName(n)+r},moved:function(t,e,o,n){return'move from <span title="(position to remove at original state)">index '+n+'</span> to <span title="(position to insert at final state)">index '+t[1]+"</span>"},textdiff:function(t,e,o,n){return"text diff"+(void 0===n?"":"number"==typeof n?" at index "+n:" at property "+wrapPropertyName(n))+', format is <a href="https://code.google.com/p/google-diff-match-patch/wiki/Unidiff">a variation of Unidiff</a>'}},formatAnyChange=function(t,e){var o=this.getDeltaType(e),n=deltaAnnotations[o],r=n&&n.apply(n,Array.prototype.slice.call(arguments,1)),a=JSON.stringify(e,null,2);"textdiff"===o&&(a=a.split("\\n").join('\\n"+\n   "')),t.indent(),t.row(a,r),t.indent(-1)};AnnotatedFormatter.prototype.format_added=formatAnyChange,AnnotatedFormatter.prototype.format_modified=formatAnyChange,AnnotatedFormatter.prototype.format_deleted=formatAnyChange,AnnotatedFormatter.prototype.format_moved=formatAnyChange,AnnotatedFormatter.prototype.format_textdiff=formatAnyChange,exports.AnnotatedFormatter=AnnotatedFormatter;var defaultInstance;exports.format=function(t,e){return defaultInstance||(defaultInstance=new AnnotatedFormatter),defaultInstance.format(t,e)};
},{"./base":4}],4:[function(require,module,exports){
var isArray="function"==typeof Array.isArray?Array.isArray:function(t){return t instanceof Array},getObjectKeys="function"==typeof Object.keys?function(t){return Object.keys(t)}:function(t){var r=[];for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&r.push(e);return r},trimUnderscore=function(t){return"_"===t.substr(0,1)?t.slice(1):t},arrayKeyToSortNumber=function(t){return"_t"===t?-1:"_"===t.substr(0,1)?parseInt(t.slice(1),10):parseInt(t,10)+.1},arrayKeyComparer=function(t,r){return arrayKeyToSortNumber(t)-arrayKeyToSortNumber(r)},BaseFormatter=function(){};BaseFormatter.prototype.format=function(t,r){var e={};return this.prepareContext(e),this.recurse(e,t,r),this.finalize(e)},BaseFormatter.prototype.prepareContext=function(t){t.buffer=[],t.out=function(){this.buffer.push.apply(this.buffer,arguments)}},BaseFormatter.prototype.typeFormattterNotFound=function(t,r){throw new Error("cannot format delta type: "+r)},BaseFormatter.prototype.typeFormattterErrorFormatter=function(t,r){return r.toString()},BaseFormatter.prototype.finalize=function(t){if(isArray(t.buffer))return t.buffer.join("")},BaseFormatter.prototype.recurse=function(t,r,e,o,n,a,i){var s=r&&a,f=s?a.value:e;if(void 0!==r||void 0!==o){var u=this.getDeltaType(r,a),p="node"===u?"a"===r._t?"array":"object":"";void 0!==o?this.nodeBegin(t,o,n,u,p,i):this.rootBegin(t,u,p);var c;try{c=this["format_"+u]||this.typeFormattterNotFound(t,u),c.call(this,t,r,f,o,n,a)}catch(e){this.typeFormattterErrorFormatter(t,e,r,f,o,n,a),"undefined"!=typeof console&&console.error&&console.error(e.stack)}void 0!==o?this.nodeEnd(t,o,n,u,p,i):this.rootEnd(t,u,p)}},BaseFormatter.prototype.formatDeltaChildren=function(t,r,e){var o=this;this.forEachDeltaKey(r,e,function(n,a,i,s){o.recurse(t,r[n],e?e[a]:void 0,n,a,i,s)})},BaseFormatter.prototype.forEachDeltaKey=function(t,r,e){var o,n=getObjectKeys(t),a="a"===t._t,i={};if(void 0!==r)for(o in r)Object.prototype.hasOwnProperty.call(r,o)&&(void 0!==t[o]||a&&void 0!==t["_"+o]||n.push(o));for(o in t)if(Object.prototype.hasOwnProperty.call(t,o)){var s=t[o];isArray(s)&&3===s[2]&&(i[s[1].toString()]={key:o,value:r&&r[parseInt(o.substr(1))]},!1!==this.includeMoveDestinations&&void 0===r&&void 0===t[s[1]]&&n.push(s[1].toString()))}a?n.sort(arrayKeyComparer):n.sort();for(var f=0,u=n.length;f<u;f++){var p=n[f];if(!a||"_t"!==p){var c=a?"number"==typeof p?p:parseInt(trimUnderscore(p),10):p,y=f===u-1;e(p,c,i[c],y)}}},BaseFormatter.prototype.getDeltaType=function(t,r){if(void 0===t)return void 0!==r?"movedestination":"unchanged";if(isArray(t)){if(1===t.length)return"added";if(2===t.length)return"modified";if(3===t.length&&0===t[2])return"deleted";if(3===t.length&&2===t[2])return"textdiff";if(3===t.length&&3===t[2])return"moved"}else if("object"==typeof t)return"node";return"unknown"},BaseFormatter.prototype.parseTextDiff=function(t){for(var r=[],e=t.split("\n@@ "),o=0,n=e.length;o<n;o++){var a=e[o],i={pieces:[]},s=/^(?:@@ )?[-+]?(\d+),(\d+)/.exec(a).slice(1);i.location={line:s[0],chr:s[1]};for(var f=a.split("\n").slice(1),u=0,p=f.length;u<p;u++){var c=f[u];if(c.length){var y={type:"context"};"+"===c.substr(0,1)?y.type="added":"-"===c.substr(0,1)&&(y.type="deleted"),y.text=c.slice(1),i.pieces.push(y)}}r.push(i)}return r},exports.BaseFormatter=BaseFormatter;
},{}],5:[function(require,module,exports){
function htmlEscape(t){for(var e=t,o=[[/&/g,"&amp;"],[/</g,"&lt;"],[/>/g,"&gt;"],[/'/g,"&apos;"],[/"/g,"&quot;"]],r=0;r<o.length;r++)e=e.replace(o[r][0],o[r][1]);return e}var base=require("./base"),BaseFormatter=base.BaseFormatter,HtmlFormatter=function(){};HtmlFormatter.prototype=new BaseFormatter,HtmlFormatter.prototype.typeFormattterErrorFormatter=function(t,e){t.out('<pre class="jsondiffpatch-error">'+e+"</pre>")},HtmlFormatter.prototype.formatValue=function(t,e){t.out("<pre>"+htmlEscape(JSON.stringify(e,null,2))+"</pre>")},HtmlFormatter.prototype.formatTextDiffString=function(t,e){var o=this.parseTextDiff(e);t.out('<ul class="jsondiffpatch-textdiff">');for(var r=0,a=o.length;r<a;r++){var i=o[r];t.out('<li><div class="jsondiffpatch-textdiff-location"><span class="jsondiffpatch-textdiff-line-number">'+i.location.line+'</span><span class="jsondiffpatch-textdiff-char">'+i.location.chr+'</span></div><div class="jsondiffpatch-textdiff-line">');for(var n=i.pieces,s=0,d=n.length;s<d;s++){var f=n[s];t.out('<span class="jsondiffpatch-textdiff-'+f.type+'">'+htmlEscape(decodeURI(f.text))+"</span>")}t.out("</div></li>")}t.out("</ul>")};var adjustArrows=function(t){t=t||document;var e=function(t){return t.textContent||t.innerText},o=function(t,e){for(var o=0,r=t.children.length;o<r;o++)e(t.children[o],o)};!function(t,e,o){for(var r=t.querySelectorAll(e),a=0,i=r.length;a<i;a++)o(r[a])}(t,".jsondiffpatch-arrow",function(t){var r=t.parentNode,a=t.children[0],i=a.children[1];a.style.display="none";var n,s=e(r.querySelector(".jsondiffpatch-moved-destination")),d=r.parentNode;if(o(d,function(t){t.getAttribute("data-key")===s&&(n=t)}),n)try{var f=n.offsetTop-r.offsetTop;a.setAttribute("height",Math.abs(f)+6),t.style.top=-8+(f>0?0:f)+"px";var l=f>0?"M30,0 Q-10,"+Math.round(f/2)+" 26,"+(f-4):"M30,"+-f+" Q-10,"+Math.round(-f/2)+" 26,4";i.setAttribute("d",l),a.style.display=""}catch(t){return}})};HtmlFormatter.prototype.rootBegin=function(t,e,o){var r="jsondiffpatch-"+e+(o?" jsondiffpatch-child-node-type-"+o:"");t.out('<div class="jsondiffpatch-delta '+r+'">')},HtmlFormatter.prototype.rootEnd=function(t){t.out("</div>"+(t.hasArrows?'<script type="text/javascript">setTimeout('+adjustArrows.toString()+",10);<\/script>":""))},HtmlFormatter.prototype.nodeBegin=function(t,e,o,r,a){var i="jsondiffpatch-"+r+(a?" jsondiffpatch-child-node-type-"+a:"");t.out('<li class="'+i+'" data-key="'+o+'"><div class="jsondiffpatch-property-name">'+o+"</div>")},HtmlFormatter.prototype.nodeEnd=function(t){t.out("</li>")},HtmlFormatter.prototype.format_unchanged=function(t,e,o){void 0!==o&&(t.out('<div class="jsondiffpatch-value">'),this.formatValue(t,o),t.out("</div>"))},HtmlFormatter.prototype.format_movedestination=function(t,e,o){void 0!==o&&(t.out('<div class="jsondiffpatch-value">'),this.formatValue(t,o),t.out("</div>"))},HtmlFormatter.prototype.format_node=function(t,e,o){var r="a"===e._t?"array":"object";t.out('<ul class="jsondiffpatch-node jsondiffpatch-node-type-'+r+'">'),this.formatDeltaChildren(t,e,o),t.out("</ul>")},HtmlFormatter.prototype.format_added=function(t,e){t.out('<div class="jsondiffpatch-value">'),this.formatValue(t,e[0]),t.out("</div>")},HtmlFormatter.prototype.format_modified=function(t,e){t.out('<div class="jsondiffpatch-value jsondiffpatch-left-value">'),this.formatValue(t,e[0]),t.out('</div><div class="jsondiffpatch-value jsondiffpatch-right-value">'),this.formatValue(t,e[1]),t.out("</div>")},HtmlFormatter.prototype.format_deleted=function(t,e){t.out('<div class="jsondiffpatch-value">'),this.formatValue(t,e[0]),t.out("</div>")},HtmlFormatter.prototype.format_moved=function(t,e){t.out('<div class="jsondiffpatch-value">'),this.formatValue(t,e[0]),t.out('</div><div class="jsondiffpatch-moved-destination">'+e[1]+"</div>"),t.out('<div class="jsondiffpatch-arrow" style="position: relative; left: -34px;">        <svg width="30" height="60" style="position: absolute; display: none;">        <defs>            <marker id="markerArrow" markerWidth="8" markerHeight="8" refx="2" refy="4"                   orient="auto" markerUnits="userSpaceOnUse">                <path d="M1,1 L1,7 L7,4 L1,1" style="fill: #339;" />            </marker>        </defs>        <path d="M30,0 Q-10,25 26,50" style="stroke: #88f; stroke-width: 2px; fill: none;        stroke-opacity: 0.5; marker-end: url(#markerArrow);"></path>        </svg>        </div>'),t.hasArrows=!0},HtmlFormatter.prototype.format_textdiff=function(t,e){t.out('<div class="jsondiffpatch-value">'),this.formatTextDiffString(t,e[0]),t.out("</div>")};var showUnchanged=function(t,e,o){var r=e||document.body,a="jsondiffpatch-unchanged-",i={showing:a+"showing",hiding:a+"hiding",visible:a+"visible",hidden:a+"hidden"},n=r.classList;if(n){if(!o)return n.remove(i.showing),n.remove(i.hiding),n.remove(i.visible),n.remove(i.hidden),void(!1===t&&n.add(i.hidden));!1===t?(n.remove(i.showing),n.add(i.visible),setTimeout(function(){n.add(i.hiding)},10)):(n.remove(i.hiding),n.add(i.showing),n.remove(i.hidden));var s=setInterval(function(){adjustArrows(r)},100);setTimeout(function(){n.remove(i.showing),n.remove(i.hiding),!1===t?(n.add(i.hidden),n.remove(i.visible)):(n.add(i.visible),n.remove(i.hidden)),setTimeout(function(){n.remove(i.visible),clearInterval(s)},o+400)},o)}},hideUnchanged=function(t,e){return showUnchanged(!1,t,e)};exports.HtmlFormatter=HtmlFormatter,exports.showUnchanged=showUnchanged,exports.hideUnchanged=hideUnchanged;var defaultInstance;exports.format=function(t,e){return defaultInstance||(defaultInstance=new HtmlFormatter),defaultInstance.format(t,e)};
},{"./base":4}],6:[function(require,module,exports){
var environment=require("../environment");if(exports.base=require("./base"),exports.html=require("./html"),exports.annotated=require("./annotated"),exports.jsonpatch=require("./jsonpatch"),!environment.isBrowser){var consoleModuleName="./console";exports.console=require(consoleModuleName)}
},{"../environment":2,"./annotated":3,"./base":4,"./html":5,"./jsonpatch":7}],7:[function(require,module,exports){
!function(){function t(){this.includeMoveDestinations=!1}function o(t){return t[t.length-1]}function e(t,o){return t.sort(o),t}function n(t){return e(t,function(t,e){var n=t.path.split("/"),r=e.path.split("/");return n.length!==r.length?n.length-r.length:d(o(n),o(r))})}function r(t,o){var e=[],n=[];return t.forEach(function(t){(o(t)?e:n).push(t)}),[e,n]}function p(t){var o=r(t,function(t){return"remove"===t.op}),e=o[0],p=o[1];return n(e).concat(p)}var i=require("./base"),u=i.BaseFormatter,a={added:"add",deleted:"remove",modified:"replace",moved:"moved",movedestination:"movedestination",unchanged:"unchanged",error:"error",textDiffLine:"textDiffLine"};t.prototype=new u,t.prototype.prepareContext=function(t){u.prototype.prepareContext.call(this,t),t.result=[],t.path=[],t.pushCurrentOp=function(t,o){var e={op:t,path:this.currentPath()};void 0!==o&&(e.value=o),this.result.push(e)},t.currentPath=function(){return"/"+this.path.join("/")}},t.prototype.typeFormattterErrorFormatter=function(t,o){t.out("[ERROR]"+o)},t.prototype.rootBegin=function(){},t.prototype.rootEnd=function(){},t.prototype.nodeBegin=function(t,o,e){t.path.push(e)},t.prototype.nodeEnd=function(t){t.path.pop()},t.prototype.format_unchanged=function(t,o,e){void 0!==e&&t.pushCurrentOp(a.unchanged,e)},t.prototype.format_movedestination=function(t,o,e){void 0!==e&&t.pushCurrentOp(a.movedestination,e)},t.prototype.format_node=function(t,o,e){this.formatDeltaChildren(t,o,e)},t.prototype.format_added=function(t,o){t.pushCurrentOp(a.added,o[0])},t.prototype.format_modified=function(t,o){t.pushCurrentOp(a.modified,o[1])},t.prototype.format_deleted=function(t){t.pushCurrentOp(a.deleted)},t.prototype.format_moved=function(t,o){t.pushCurrentOp(a.moved,o[1])},t.prototype.format_textdiff=function(){throw"not implimented"},t.prototype.format=function(t,o){var e={};return this.prepareContext(e),this.recurse(e,t,o),e.result},exports.JSONFormatter=t;var f,d=function(t,o){var e=parseInt(t,10),n=parseInt(o,10);return isNaN(e)||isNaN(n)?0:n-e},c=function(o,e){return f||(f=new t),p(f.format(o,e))};exports.log=function(t,o){console.log(c(t,o))},exports.format=c}();
},{"./base":4}]},{},[1])(1)
});


//# sourceMappingURL=jsondiffpatch-formatters.min.map